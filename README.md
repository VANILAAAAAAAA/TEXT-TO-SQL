**实现流程如下：**

用户获取数据库列表，选择数据库，选择后将对应数据库信息（表名和对应字段名）输入到大模型的prompt中，之后用户输入自然语言， 大模型由于经过处理，输出的格式为： /自然语言聊天/ SQL语句

模型的整个输出一定是一个完整的sql脚本。

有了数据库信息后模型的SQL语句能大大增加准确率。

之后大模型输出sql语句直接对数据库进行操作。

这其中有几个接口：

1、获取连接中的数据库/get_databases，用户能看到数据库列表并选择。

2、获取选中数据库的表/get_tables，在/get_databases返回的数据库信息进行请求，用户能看到表并选择

3、获取表的具体信息/get_database_details，在前两个接口返回的对应数据库和表进行请求，用户能看到所选表的具体信息，字段名和备注。 这些信息会被传入大模型的提示词中。

4、获取大模型输出/get_model_output，在/get_database_details中获得的字段名与表名组合成提示词，再和用户输入组合进行请求，用户能看到大模型 的输出。

5、获取最终结果/execute_query，用户能看到sql语句最终执行结果。这个结果是/get_model_output中返回的sql脚本的执行结果。

大模型的api和数据库都是外部链接。

***

**The implementation process is as follows:**

The user retrieves a list of databases and selects one. After selection, the corresponding database information (table names and corresponding field names) is input into the prompt for the large model. Subsequently, the user inputs natural language, and the large model, after processing, outputs in the format: /natural language chat/ SQL statement.

The entire output from the model must be a complete SQL script.

With the database information, the accuracy of the model's SQL statements can be significantly improved.

The SQL statements generated by the large model are then used to perform operations directly on the database.

There are several interfaces involved:

Get List of Databases /get_databases: Users can see the list of databases and make a selection.

Get Tables in Selected Database /get_tables: A request is made based on the database information returned from /get_databases, allowing users to see and select tables.

Get Specific Information of Selected Table /get_database_details: A request is made based on the corresponding database and table returned from the first two interfaces, allowing users to see detailed information about the selected table, including field names and comments. This information will be passed into the prompt for the large model.

Get Model Output /get_model_output: The field names and table names obtained from /get_database_details are combined to form the prompt, which is then combined with the user's input to make a request. Users can see the output from the large model.

Get Final Result /execute_query: Users can see the final execution result of the SQL statement. This result is derived from executing the SQL script returned in /get_model_output.

Both the large model API and the database are external links.
